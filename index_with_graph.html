<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Config UI</title>
  <style>
    :root {
      --primary-color: #a064e7;
      --accent-color: #8950cc;
      --bg-color: #262626;
      --text-color: white;
    }

    body {
      margin: 0;
      padding: 20px;
      font-family: Impact, sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
    }

    textarea {
      width: 100%;
      height: 180px;
      border-radius: 8px;
      border-width: 2px;
      border-style: solid;
      border-color: var(--primary-color);
      padding: 10px;
      resize: vertical;
      font-family: monospace;
    }
    textarea:focus {
      outline: none;
      border-color: var(--primary-color);
    }


    .container {

      inset: 20px; /* adds margin on all 4 sides */
      background: white;
      color: black;
      padding: 20px;
      border-radius: 8px;
      border: 2px solid var(--primary-color);
      box-sizing: border-box;
    }


    .box {
      flex: 1;
      padding: 15px;
      background: white;
      border-radius: 8px;
      border-width: 2px;
      border-style: solid;
      border-color: var(--primary-color);
      color: var(--primary-color);
      overflow-y: auto; 
      text-align: center;
    }

    button {
      background-color: var(--accent-color);
      color: white;
      font-family: Impact, sans-serif;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
    }

    button, input[type="text"], select {
      padding: 10px;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      margin: 0.5rem 0;
    }

    button:hover {
      opacity: 0.85;
    }

    .form-row {
      display: flex;
      align-items: center;
      margin-bottom: 1rem;
      gap: 10px; /* space between label and input */
    }

    .form-row label {
      width: 50px; /* fixed width for alignment */
      /*font-weight: bold;*/
      font-size: 20px;
    }

    .number-input {
      flex: 1; /* fill remaining space */
      padding: 10px;
      border-radius: 8px;
      border: 2px solid var(--primary-color);
      font-family: monospace;
      font-size: 16px;
      box-sizing: border-box;
    }

    input[type="checkbox"] {
      width: 18px;
      height: 18px;
      margin-right: 8px;
      border-radius: 8px;
      border: 2px solid var(--primary-color);
      accent-color: var(--primary-color);
    }

    .pid-grid {
      display: grid;
      grid-template-columns: auto 1fr 1fr;
      gap: 8px 12px;
      align-items: center;
    }

    .title {
      font-size: 25px;
      text-align: center;
      font-family: Impact, sans-serif;
      color: var(--accent-color);
    }

    .label {
      font-size: 20px;
      text-align: left;
      font-family: Impact, sans-serif;
      color: var(--accent-color);
    }

    .label_fixed {
      width: 150px;
      font-size: 20px;
      text-align: left;
      font-family: Impact, sans-serif;
      color: var(--accent-color);
    }

    .header {
      font-size: 40px;
      text-align: center;
      font-family: Impact, sans-serif;
      margin-bottom: 20px;
      color: var(--accent-color);
    }

    .vbox {
      display: flex;
      flex-direction: column;
      
    }
    .hbox{
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 20px;
      margin-top: 20px;
    }

  </style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>
<body>

  <div class="container">

  <div style="text-align:center; margin-bottom: 20px;">
    <button onclick="showPage('config')">Configuration</button>
    <button onclick="showPage('graph')">Graph View</button>
  </div>

  <div id="config-page">

    <h1 class="header">DuoDrive Configuration Tool</h1>
    
    <div class = "hbox">
      <div class = "vbox">
        <button id="connectBtn">CONNECT DRIVER</button>
        <button>SEND CONFIG</button>
        <button>SAVE CONFIG</button>
      </div>
      <textarea id="outputLog" readonly placeholder="UART logs will appear here..."></textarea>
    </div>


    

    <div class="hbox">
      <div class="box">
        <div class="title">MOTOR 1</div>
        <div> </div>
        <div class="pid-grid">
          <div></div>
          <div class="label">POSITION</div>
          <div class="label">VELOCITY</div>

          <div class="label">Kp:</div>
          <input type="number" class="number-input" id="p1kp" step="0.01" value="1.0" />
          <input type="number" class="number-input" id="v1kp" step="0.01" value="1.0" />

          <div class="label">Ki:</div>
          <input type="number" class="number-input" id="p1ki" step="0.01" value="0.1" />
          <input type="number" class="number-input" id="v1ki" step="0.01" value="0.1" />

          <div class="label">Kd:</div>
          <input type="number" class="number-input" id="p1kd" step="0.01" value="0.05" />
          <input type="number" class="number-input" id="v1kd" step="0.01" value="0.05" />
        </div>

        <div class="hbox">
          <div class="label_fixed">REVERSE ENCODER</div>
          <input type="checkbox" id="myCheckbox" />
        </div>

        <div class="hbox">
          <div class="label_fixed">ENCODER PPR</div>
          <input type="number" class="number-input" id="pp1" step="1" value="256" />
        </div>

        <div class="hbox">
          <div class="label_fixed">MAX RPM</div>
          <input type="number" class="number-input" id="max1" step="0.1" value="200" />
        </div>

        <div class="hbox">
          <div class="label_fixed">RAMP SPEED</div>
          <input type="number" class="number-input" id="pp1" step="1" value="990" />
        </div>

        <div class="hbox">
          <div class="label_fixed">PID ARR</div>
          <input type="number" class="number-input" id="pp1" step="1" value="99" />
          <div class="label">~</div>
        </div>

        <div class="hbox">
          <div class="label_fixed">POS PID SCALE</div>
          <input type="number" class="number-input" id="pp1" step="1" value="2" />
          <div class="label">~</div>
        </div>

        <div class="hbox">
          <div class="label_fixed">VEL PID SCALE</div>
          <input type="number" class="number-input" id="pp1" step="1" value="1" />
          <div class="label">~</div>
        </div>

      </div>

            <div class="box">
        <div class="title">MOTOR 2</div>
        <div> </div>
        <div class="pid-grid">
          <div></div>
          <div class="label">POSITION</div>
          <div class="label">VELOCITY</div>

          <div class="label">Kp:</div>
          <input type="number" class="number-input" id="p1kp" step="0.01" value="1.0" />
          <input type="number" class="number-input" id="v1kp" step="0.01" value="1.0" />

          <div class="label">Ki:</div>
          <input type="number" class="number-input" id="p1ki" step="0.01" value="0.1" />
          <input type="number" class="number-input" id="v1ki" step="0.01" value="0.1" />

          <div class="label">Kd:</div>
          <input type="number" class="number-input" id="p1kd" step="0.01" value="0.05" />
          <input type="number" class="number-input" id="v1kd" step="0.01" value="0.05" />
        </div>

        <div class="hbox">
          <div class="label_fixed">REVERSE ENCODER</div>
          <input type="checkbox" id="myCheckbox" />
        </div>

        <div class="hbox">
          <div class="label_fixed">ENCODER PPR</div>
          <input type="number" class="number-input" id="pp1" step="1" value="256" />
        </div>

        <div class="hbox">
          <div class="label_fixed">MAX RPM</div>
          <input type="number" class="number-input" id="max1" step="0.1" value="200" />
        </div>

        <div class="hbox">
          <div class="label_fixed">RAMP SPEED</div>
          <input type="number" class="number-input" id="pp1" step="1" value="990" />
        </div>

        <div class="hbox">
          <div class="label_fixed">PID ARR</div>
          <input type="number" class="number-input" id="pp1" step="1" value="99" />
        </div>

        <div class="hbox">
          <div class="label_fixed">POS PID SCALE</div>
          <input type="number" class="number-input" id="pp1" step="1" value="2" />
        </div>

        <div class="hbox">
          <div class="label_fixed">VEL PID SCALE</div>
          <input type="number" class="number-input" id="pp1" step="1" value="1" />
        </div>

      </div>
    </div>
  </div>


<script>
function showPage(page) {
  document.getElementById('config-page').style.display = (page === 'config') ? 'block' : 'none';
  document.getElementById('graph-page').style.display = (page === 'graph') ? 'block' : 'none';
}

let chartCtx = null;
let chart = null;

function setupChart() {
  const ctx = document.getElementById('myChart').getContext('2d');
  chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: [],
      datasets: [{
        label: 'Speed',
        data: [],
        borderColor: '#a064e7',
        backgroundColor: 'rgba(160,100,231,0.1)',
        fill: true,
        tension: 0.3
      }]
    },
    options: {
      animation: false,
      scales: {
        x: {
          title: { display: true, text: 'Time' }
        },
        y: {
          title: { display: true, text: 'Value' }
        }
      }
    }
  });
}

function addDataPoint(value) {
  const now = new Date().toLocaleTimeString();
  chart.data.labels.push(now);
  chart.data.datasets[0].data.push(value);
  if (chart.data.labels.length > 50) {
    chart.data.labels.shift();
    chart.data.datasets[0].data.shift();
  }
  chart.update();
}

// Setup chart after page load
window.addEventListener('load', () => {
  setupChart();
});

// Example UART parsing logic â€” replace with your actual UART read loop
function simulateSerialInput() {
  setInterval(() => {
    const simulatedValue = Math.random() * 100;  // simulate random data
    addDataPoint(simulatedValue);
  }, 500);  // every 500ms
}

// Uncomment below to test without serial input
// simulateSerialInput();
</script>

</body>
</html>
